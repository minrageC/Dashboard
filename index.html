<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Profissional - 30 Dias</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gradient-to-br from-blue-100 via-purple-100 to-pink-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 text-gray-800 dark:text-gray-100">

<div class="flex h-screen">
  <!-- Sidebar -->
  <aside class="w-64 bg-white/80 dark:bg-gray-800/80 backdrop-blur shadow-lg flex flex-col">
    <div class="p-4 text-center font-bold text-lg border-b border-gray-200 dark:border-gray-700">üìä Meu Dashboard</div>
    <nav class="flex-1 p-4 space-y-2">
      <a href="#" onclick="mostrarPagina('banca')" class="block p-3 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition">üí∞ Gest√£o de Banca</a>
      <a href="#" onclick="mostrarPagina('entradas')" class="block p-3 rounded-lg bg-green-500 text-white hover:bg-green-600 transition">üìë Gest√£o de Entradas</a>
      <a href="#" onclick="mostrarPagina('outro')" class="block p-3 rounded-lg bg-purple-500 text-white hover:bg-purple-600 transition">‚öôÔ∏è Outro Projeto</a>
    </nav>
    <div class="p-4 text-sm text-gray-500 dark:text-gray-400 border-t border-gray-200 dark:border-gray-700">¬© 2025 Meu Dashboard</div>
  </aside>

  <!-- Conte√∫do -->
  <main class="flex-1 p-6 overflow-y-auto">
    <div class="flex justify-between items-center mb-6">
      <h1 id="tituloPagina" class="text-2xl font-bold">üí∞ Gest√£o de Banca</h1>
      <button onclick="alternarTema()" class="px-3 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:scale-105 transition">üåô</button>
    </div>

    <!-- P√°gina Gest√£o de Banca -->
    <div id="pagina-banca">
      <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg">
        <h2 class="text-xl font-semibold mb-4">Simula√ß√£o de Gest√£o de Banca (30 dias)</h2>

        <label class="block font-semibold mt-2">Banca Inicial (MZN)</label>
        <input type="number" id="banca" value="0" placeholder="Digite a banca inicial" class="w-full p-2 rounded-lg border dark:border-gray-600 dark:bg-gray-700">

        <label class="block font-semibold mt-2">Meta (% de lucro)</label>
        <input type="number" id="meta" value="0" placeholder="Digite a meta (%)" class="w-full p-2 rounded-lg border dark:border-gray-600 dark:bg-gray-700">

        <label class="block font-semibold mt-2">Stop Loss (% perda m√°xima)</label>
        <input type="number" id="stop_loss" value="0" placeholder="Digite o stop loss (%)" class="w-full p-2 rounded-lg border dark:border-gray-600 dark:bg-gray-700">

        <div class="flex gap-2 mt-4">
          <button onclick="iniciarBanca()" class="flex-1 bg-blue-600 text-white p-2 rounded-lg shadow hover:bg-blue-700">Iniciar 30 dias</button>
          <button onclick="resetarBanca()" class="flex-1 bg-gray-500 text-white p-2 rounded-lg shadow hover:bg-gray-600">Reset</button>
        </div>

        <div id="statusBadge" class="mt-4 p-2 rounded font-bold text-center hidden"></div>
        <div id="confirmMeta" class="mt-4 hidden flex gap-2 justify-center">
          <span class="font-semibold">Meta atingida?</span>
          <button onclick="confirmarMeta(true)" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Sim</button>
          <button onclick="confirmarMeta(false)" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">N√£o</button>
        </div>

        <p id="resultado" class="mt-4"></p>

        <table id="tabela" class="w-full mt-4 border-collapse hidden">
          <thead>
            <tr class="bg-blue-600 text-white">
              <th class="p-2">Dia</th>
              <th class="p-2">Banca Inicial</th>
              <th class="p-2">Lucro</th>
              <th class="p-2">Banca Final</th>
            </tr>
          </thead>
          <tbody class="text-center"></tbody>
        </table>

        <canvas id="grafico" class="mt-6"></canvas>
      </div>
    </div>

    <!-- P√°gina Gest√£o de Entradas -->
    <div id="pagina-entradas" class="hidden">
      <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg">
        <h2 class="text-xl font-semibold mb-4">Plano de Gest√£o de Entradas</h2>

        <label for="numEntradas" class="block font-semibold">N√∫mero de entradas:</label>
        <input type="number" id="numEntradas" min="1" max="20" value="0" placeholder="N√∫mero de entradas" class="p-2 rounded-lg border dark:border-gray-600 dark:bg-gray-700">
        <div class="mt-3 flex gap-2">
          <button id="gerarBtn" class="flex-1 bg-green-600 text-white p-2 rounded-lg shadow hover:bg-green-700">Gerar Tabela</button>
          <button id="resetBtn" class="flex-1 bg-gray-500 text-white p-2 rounded-lg shadow hover:bg-gray-600 hidden">Resetar Valores</button>
        </div>

        <table id="tabelaEntradas" class="w-full mt-4 border-collapse hidden">
          <caption class="text-lg font-semibold mb-2">Lucro Total: <span id="lucroTotal">0</span> MZN</caption>
          <thead>
            <tr class="bg-green-600 text-white">
              <th class="p-2">Entrada</th>
              <th class="p-2">Aposta (MZN)</th>
              <th class="p-2">Multiplicador</th>
              <th class="p-2">Lucro da Aposta</th>
              <th class="p-2">Lucro Acumulado</th>
            </tr>
          </thead>
          <tbody class="text-center"></tbody>
        </table>
      </div>
    </div>

    <!-- P√°gina Outro -->
    <div id="pagina-outro" class="hidden">
      <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg">
        <h2 class="text-xl font-semibold">Outro Projeto</h2>
        <p>Adicione aqui seu pr√≥ximo projeto...</p>
      </div>
    </div>

  </main>
</div>

<script>
// ===== Navega√ß√£o =====
function mostrarPagina(nome) {
  document.querySelectorAll('[id^="pagina-"]').forEach(el => el.classList.add("hidden"));
  document.getElementById(`pagina-${nome}`).classList.remove("hidden");
  document.getElementById("tituloPagina").textContent =
    nome === 'banca' ? "üí∞ Gest√£o de Banca" :
    nome === 'entradas' ? "üìë Gest√£o de Entradas" :
    "‚öôÔ∏è Outro Projeto";
}

// ===== Tema Escuro =====
const temaSalvo = localStorage.getItem('tema');
if (temaSalvo === 'dark') {
  document.documentElement.classList.add('dark');
}

function alternarTema() {
  document.documentElement.classList.toggle('dark');
  if (document.documentElement.classList.contains('dark')) {
    localStorage.setItem('tema', 'dark');
  } else {
    localStorage.setItem('tema', 'light');
  }
}

// ===== Gest√£o de Entradas =====
document.getElementById("gerarBtn").addEventListener("click", () => {
  const num = parseInt(document.getElementById("numEntradas").value);
  if (!num || num <= 0) {
    alert("Digite um n√∫mero v√°lido de entradas!");
    return;
  }

  let tbody = document.getElementById("tabelaEntradas").querySelector("tbody");
  tbody.innerHTML = "";
  let lucroAcumulado = 0;
  let apostaInicial = 100; // valor fixo, pode alterar

  for (let i = 1; i <= num; i++) {
    let multiplicador = 2; // fixo para exemplo
    let lucro = apostaInicial * (multiplicador - 1);
    lucroAcumulado += lucro;
    tbody.innerHTML += `
      <tr class="border-t">
        <td class="p-2">${i}</td>
        <td class="p-2">${apostaInicial.toFixed(2)}</td>
        <td class="p-2">${multiplicador.toFixed(2)}</td>
        <td class="p-2">${lucro.toFixed(2)}</td>
        <td class="p-2">${lucroAcumulado.toFixed(2)}</td>
      </tr>`;
  }

  document.getElementById("lucroTotal").textContent = lucroAcumulado.toFixed(2);
  document.getElementById("tabelaEntradas").classList.remove("hidden");
  document.getElementById("resetBtn").classList.remove("hidden");
});

document.getElementById("resetBtn").addEventListener("click", () => {
  document.getElementById("tabelaEntradas").classList.add("hidden");
  document.getElementById("resetBtn").classList.add("hidden");
  document.getElementById("lucroTotal").textContent = "0";
  document.getElementById("numEntradas").value = 0;
});

// ===== Gest√£o de Banca com localStorage =====
let chartBanca;
let banca, bancaMeta, bancaStopLoss;
let evolucao = [];
let metaConfirmada = null;

// Recupera dados salvos
window.addEventListener('load', () => {
  const dados = JSON.parse(localStorage.getItem('banca30dias'));
  if (dados) {
    banca = dados.banca;
    evolucao = dados.evolucao;
    bancaMeta = dados.bancaMeta;
    bancaStopLoss = dados.bancaStopLoss;
    metaConfirmada = dados.metaConfirmada;
    document.getElementById("banca").value = dados.bancaInicial;
    document.getElementById("meta").value = dados.metaPercent;
    document.getElementById("stop_loss").value = dados.stopPercent * 100;
    preencherTabelaBanca();
    desenharGraficoBanca(evolucao);
    if (metaConfirmada !== null) mostrarStatus(metaConfirmada ? "‚úÖ Meta confirmada pelo usu√°rio" : "‚ö†Ô∏è Meta n√£o confirmada", metaConfirmada ? "meta" : "stop");
  }
});

function iniciarBanca() {
  banca = parseFloat(document.getElementById("banca").value);
  const metaPercent = parseFloat(document.getElementById("meta").value);
  const stopPercent = parseFloat(document.getElementById("stop_loss").value) / 100;
  if (!banca || !metaPercent || !stopPercent) { alert("Preencha todos os valores antes de iniciar."); return; }

  bancaMeta = banca * (1 + metaPercent / 100);
  bancaStopLoss = banca * (1 - stopPercent);
  evolucao = [banca];
  metaConfirmada = null;

  document.getElementById("resultado").innerHTML = `Meta: <b>${bancaMeta.toFixed(2)} MZN</b><br>Stop Loss: <b>${bancaStopLoss.toFixed(2)} MZN</b>`;
  document.getElementById("confirmMeta").classList.add("hidden");

  for (let dia = 1; dia <= 30; dia++) {
    let lucro = banca * 0.20;
    let bancaFinal = banca + lucro;
    evolucao.push(bancaFinal);
    banca = bancaFinal;

    if (!document.getElementById("confirmMeta").classList.contains("flex") && banca >= bancaMeta && metaConfirmada === null) {
      document.getElementById("confirmMeta").classList.remove("hidden");
    }

    if (banca <= bancaStopLoss) {
      mostrarStatus(`‚ùå Stop Loss atingido no dia ${dia}`, "stop");
    }
  }

  preencherTabelaBanca();
  desenharGraficoBanca(evolucao);
  salvarLocalStorage(metaPercent, stopPercent);
}

function preencherTabelaBanca() {
  const corpo = document.getElementById("tabela").querySelector("tbody");
  corpo.innerHTML = "";
  let b = evolucao[0];
  for (let i = 1; i < evolucao.length; i++) {
    corpo.innerHTML += `<tr class="border-t">
      <td class="p-2">${i}</td>
      <td class="p-2">${b.toFixed(2)}</td>
      <td class="p-2">${(evolucao[i]-b).toFixed(2)}</td>
      <td class="p-2">${evolucao[i].toFixed(2)}</td>
    </tr>`;
    b = evolucao[i];
  }
  document.getElementById("tabela").classList.remove("hidden");
}

function confirmarMeta(decisao) {
  metaConfirmada = decisao;
  mostrarStatus(decisao ? "‚úÖ Meta confirmada pelo usu√°rio" : "‚ö†Ô∏è Meta n√£o confirmada", decisao ? "meta" : "stop");
  document.getElementById("confirmMeta").classList.add("hidden");
  salvarLocalStorage(parseFloat(document.getElementById("meta").value), parseFloat(document.getElementById("stop_loss").value)/100);
}

function mostrarStatus(msg, tipo) {
  const badge = document.getElementById("statusBadge");
  badge.className = `mt-4 p-2 rounded font-bold text-center ${tipo === "meta" ? "bg-green-500 text-white" : "bg-red-500 text-white"}`;
  badge.textContent = msg;
  badge.classList.remove("hidden");
}

function desenharGraficoBanca(dados) {
  const ctx = document.getElementById("grafico").getContext("2d");
  if (chartBanca) chartBanca.destroy();
  chartBanca = new Chart(ctx, {
    type: "line",
    data: {
      labels: dados.map((_, i) => `Dia ${i}`),
      datasets: [{
        label: "Evolu√ß√£o da Banca",
        data: dados,
        borderColor: "#3b82f6",
        backgroundColor: "rgba(59,130,246,0.2)",
        fill: true,
        tension: 0.3,
        pointRadius: 4,
      }]
    }
  });
}

function resetarBanca() {
  banca = 0;
  evolucao = [];
  metaConfirmada = null;
  document.getElementById("banca").value = 0;
  document.getElementById("meta").value = 0;
  document.getElementById("stop_loss").value = 0;
  document.getElementById("resultado").innerHTML = "";
  document.getElementById("statusBadge").classList.add("hidden");
  document.getElementById("confirmMeta").classList.add("hidden");
  document.getElementById("tabela").classList.add("hidden");
  if (chartBanca) chartBanca.destroy();
  localStorage.removeItem("banca30dias");
}

function salvarLocalStorage(metaPercent, stopPercent) {
  localStorage.setItem('banca30dias', JSON.stringify({
    bancaInicial: parseFloat(document.getElementById("banca").value),
    banca: banca,
    evolucao: evolucao,
    bancaMeta: bancaMeta,
    bancaStopLoss: bancaStopLoss,
    metaConfirmada: metaConfirmada,
    metaPercent: metaPercent,
    stopPercent: stopPercent
  }));
}
</script>

</body>
</html>
